\documentclass[../main-sheet.tex]{subfiles}
\usepackage{../style}
\graphicspath{ {../img/} }
\backgroundsetup{contents={}}
\begin{document}
\begin{prob}
    Solve the wave equation
    \[\frac{\partial^2 u}{\partial t^2}=4\frac{\partial^2 u}{\partial x^2}\]
    subject to \(u(0,t)=u(4,t)=0\), \(u_t(x,0)=0\) and \(u(x,0)=x(4-x)\) by taking step length in \(x\) is \(h=1\). [\(0\leq x\leq 4\), \(0\leq t\leq2\)]
\end{prob}
\begin{soln}
    Standard form of wave equation is 
    \[\frac{\partial^2 u}{\partial t^2}=c^2\frac{\partial^2 u}{\partial x^2}\]
\end{soln}
so, \(c^2=4\;\;\Rightarrow\;c=\pm 2\)\\
Given that step length in \(x\) is \(h=1\).\\
\(\therefore \) step length in \(t\) is \(k=h/c=1/2=0.5\).\\
By boundary conditions, \(0\leq x\leq 4\) which is divided as,
\[x_0=0,\;\;x_1=x_0+h=1,\;\;x_2=x_0+2h=x_1+h=2,\;\;x_3=x_0+3h=x_2+h=3,\;\;x_4=x_0+4h=x_3+h=4\]
Now,
\[t_0=0,\;\;t_1=t_0+k=0.5,\;\;t_2=t_0+2k=1,\;\;t_3=t_0+3k=1.5,\;\;t_4=t_0+4k=2\]
\(c^2=4\); \(h=1\) choose \(\lambda=1\), \(\therefore \;\;\lambda=\frac{k a}{h}\;\Rightarrow\;\;k=1/2\)\\
As \(\lambda=1\); explicit formula is used,
\begin{center}
    \begin{tikzpicture}[table/.style={
        matrix of nodes,
        row sep=-\pgflinewidth,
        column sep=-\pgflinewidth,
        nodes={rectangle,text width=5em,align=center},
        text depth=1.25ex,
        text height=3.5ex,
        nodes in empty cells
      },]
      \matrix (mat) [table]
      {
      & $x_0=0$ & $x_1=1$ & $x_2=2$ & $x_3=3$ & $x_4=4$ \\
      $t_0=0$ & $u_{0,0}=0$  & $u_{1,0}=3$ &$u_{2,0}=4$ &$u_{3,0}=3$ & $u_{4,0}=0$ \\
      $t_1=0.5$ & $u_{0,1}=0$& $u_{1,1}=2$ &$u_{2,1}=3$ &$u_{3,1}=2$ & $u_{4,1}=0$ \\
      $t_2=1$ &$u_{0,2}=0$ & $u_{1,2}=0$ & $u_{2,2}=0$ & $u_{3,2}=0$ & $u_{4,2}=0$ \\
      $t_3=1.5$ &$u_{0,3}=0$ & $u_{1,3}=-2$&$u_{2,3}=-3$ & $u_{3,3}=-2$ & $u_{4,3}=0$ \\
      $t_4=2$ & $u_{0,4}=0$ & $u_{1,4}=-3$ & $u_{2,4}=-4$ & $u_{3,4}=-3$ & $u_{4,4}=0$ \\
      };
      \foreach \x in {1,...,5}
      {
        \draw 
          ([xshift=-.5\pgflinewidth]mat-\x-1.south west) --   
          ([xshift=-.5\pgflinewidth]mat-\x-6.south east);
        }
      \foreach \x in {1,...,5}
      {
        \draw 
          ([yshift=.5\pgflinewidth]mat-1-\x.north east) -- 
          ([yshift=.5\pgflinewidth]mat-6-\x.south east);
      }
      \draw[thick,-latex]  ([yshift=5pt,xshift=5pt]mat-4-3.west)node[left] {$+$} to ([yshift=5pt,xshift=0pt]mat-3-2.south) ;
\draw[thick,-latex]  ([yshift=5pt,xshift=-5pt]mat-4-3.east)node[right] {$+$} to ([yshift=5pt,xshift=0pt]mat-3-4.south) ;
\draw[thick,-latex]  ([yshift=5pt]mat-3-4.center)node[left] {$-$} to ([yshift=5pt,xshift=0pt]mat-2-3.south) ;
\end{tikzpicture}
\end{center}
\end{document}